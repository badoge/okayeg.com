const months={0:"1-Month",2:"2-Month",3:"3-Month",6:"6-Month",9:"9-Month",12:"1-Year",18:"1.5-Year",24:"2-Year",30:"2.5-Year",36:"3-Year",42:"3.5-Year",48:"4-Year",54:"4.5-Year",60:"5-Year",66:"5.5-Year",72:"6-Year",78:"6.5-Year",84:"7-Year",90:"7.5-Year",96:"8-Year",102:"8.5-Year",108:"9-Year",114:"9.5-Year",120:"10-Year",126:"10.5-Year",132:"11-Year",138:"11.5-Year",144:"12-Year",2e3:"1-Month Tier 2",2002:"2-Month Tier 2",2003:"3-Month Tier 2",2006:"6-Month Tier 2",2009:"9-Month Tier 2",2012:"1-Year Tier 2",2018:"1.5-Year Tier 2",2024:"2-Year Tier 2",2030:"2.5-Year Tier 2",2036:"3-Year Tier 2",2042:"3.5-Year Tier 2",2048:"4-Year Tier 2",2054:"4.5-Year Tier 2",2060:"5-Year Tier 2",2066:"5.5-Year Tier 2",2072:"6-Year Tier 2",2078:"6.5-Year Tier 2",2084:"7-Year Tier 2",2090:"7.5-Year Tier 2",2096:"8-Year Tier 2",2102:"8.5-Year Tier 2",2108:"9-Year Tier 2",2114:"9.5-Year Tier 2",2120:"10-Year Tier 2",2126:"10.5-Year Tier 2",2132:"11-Year Tier 2",2138:"11.5-Year Tier 2",2144:"12-Year Tier 2",3e3:"1-Month Tier 3",3002:"2-Month Tier 3",3003:"3-Month Tier 3",3006:"6-Month Tier 3",3009:"9-Month Tier 3",3012:"1-Year Tier 3",3018:"1.5-Year Tier 3",3024:"2-Year Tier 3",3030:"2.5-Year Tier 3",3036:"3-Year Tier 3",3042:"3.5-Year Tier 3",3048:"4-Year Tier 3",3054:"4.5-Year Tier 3",3060:"5-Year Tier 3",3066:"5.5-Year Tier 3",3072:"6-Year Tier 3",3078:"6.5-Year Tier 3",3084:"7-Year Tier 3",3090:"7.5-Year Tier 3",3096:"8-Year Tier 3",3102:"8.5-Year Tier 3",3108:"9-Year Tier 3",3114:"9.5-Year Tier 3",3120:"10-Year Tier 3",3126:"10.5-Year Tier 3",3132:"11-Year Tier 3",3138:"11.5-Year Tier 3",3144:"12-Year Tier 3"},svg='<svg style="fill: #a970ff; position: relative;" type="color-fill-current" width="16px" height="16px" version="1.1" viewBox="0 0 16 16" x="0px" y="0px"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.5 3.5L8 2L3.5 3.5L2 8L3.5 12.5L8 14L12.5 12.5L14 8L12.5 3.5ZM7.00008 11L11.5 6.5L10 5L7.00008 8L5.5 6.5L4 8L7.00008 11Z"></path></svg>',staffpic='<img src="/pics/staff.png" loading="lazy" width="16px" height="16px" title="Twitch staff" alt="Twitch staff">',spinner='<div style="display: table; margin: 0 auto;" class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div>';let copyTooltip,token;async function getProfile(){let e=location.hash.replace("#","").toLowerCase().replace(/\s/g,"");if(document.getElementById("username").value?e=document.getElementById("username").value.toLowerCase().replace(/\s/g,""):document.getElementById("username").value=e,e){document.getElementById("mainRow").style.display="",document.getElementById("title1").innerHTML=`${e}'s Channel settings`,document.getElementById("title2").innerHTML=`${e}'s Stats`,document.getElementById("title3").innerHTML=`${e}'s NFEs`;try{let t=await fetch(`https://api.okayeg.com/profile?username=${e}`),n=await t.json();if(n.channelInfo){let e=n.channelInfo;document.getElementById("globalCD").innerHTML=`${e.cd}s`,document.getElementById("userCD").innerHTML=`${e.usercd}s`,document.getElementById("allowOnline").innerHTML=""+(1===e.allowonline?"YES":"NO"),document.getElementById("muted").innerHTML=""+(1===e.muted?"Unmuted":"Muted"),document.getElementById("commandsUsed").innerHTML=`${e.uses.toLocaleString()}`;let t="<ul>";for(let a=0,o=n.commands.length;a<o;a++)1===n.commands[a].toggleable&&(null!=e[n.commands[a]._id]&&1!==e[n.commands[a]._id]||(t+=`\n              <li>${n.commands[a]._id}</li>\n              <ul><li>Can be disabled using <kbd>=toggle ${n.commands[a]._id}</kbd></li></ul>`));t+="</ul>",document.getElementById("enabledCommands").innerHTML=t;let a="<ul>";for(let t=0,o=n.commands.length;t<o;t++)1===n.commands[t].toggleable&&0===e[n.commands[t]._id]&&(a+=`\n              <li>${n.commands[t]._id}</li>\n              <ul><li>Can be enabled using <kbd>=toggle ${n.commands[t]._id}</kbd></li></ul>`);a+="</ul>",document.getElementById("disabledCommands").innerHTML=a}else document.getElementById("channelSettings").innerHTML=`Bot not added to ${e}'s channel`;if(n.userInfo){let e=n.userInfo;document.getElementById("season").innerHTML=n.season,document.getElementById("egg").innerHTML=`\n        ${e.egs.toLocaleString()} ${1==e.egs?"eg":"egs"}<br>\n        +egs: ${e.plus.toLocaleString()}, 0egs: ${e.zero.toLocaleString()}, -egs: ${e.negative.toLocaleString()}<br>\n        ${e.egseaten.toLocaleString()} ${1==e.egseaten?"eg":"egs"} eaten`,document.getElementById("commands").innerHTML=`\n        =eg used ${(e?.eguses||0).toLocaleString()} ${1==e?.eguses?"time":"times"}<br>\n        Other commands used ${e.uses.toLocaleString()} ${1==e.uses?"time":"times"}`,document.getElementById("coinflip").innerHTML=`\n        Played ${e.coinflips.toLocaleString()} ${1==e.coinflips?"time":"times"}<br>\n        Won ${e.coinflipwins} ${1==e.coinflipwins?"time":"times"} (${Math.round(e.coinflipwins/e.coinflips*100)||0}% win rate)<br>\n        Biggest win: ${e.biggestcoinflipwin} ${1==e.biggestcoinflipwin?"eg":"egs"}<br>\n        Biggest loss: ${e.biggestcoinfliploss} ${1==e.biggestcoinfliploss?"eg":"egs"}<br>`,document.getElementById("roulette").innerHTML=`\n        Played ${e.roulettes.toLocaleString()} ${1==e.roulettes?"time":"times"}<br>\n        Won ${e.rouletteswon} ${1==e.rouletteswon?"time":"times"} (${Math.round(e.rouletteswon/e.roulettes*100)||0}% win rate)<br>\n        Biggest win: ${e.biggestroulettewin} ${1==e.biggestroulettewin?"eg":"egs"}<br>\n        Biggest loss: ${e.biggestrouletteloss} ${1==e.biggestrouletteloss?"eg":"egs"}<br>`,document.getElementById("duels").innerHTML=`\n        Played ${e.duels.toLocaleString()} ${1==e.duels?"time":"times"}<br>\n        Won ${e.duelswon} ${1==e.duelswon?"time":"times"} (${Math.round(e.duelswon/e.duels*100)||0}% win rate)<br>\n        Biggest win: ${e.biggestduelwin} ${1==e.biggestduelwin?"eg":"egs"}<br>\n        Biggest loss: ${e.biggestduelloss} ${1==e.biggestduelloss?"eg":"egs"}<br>`,document.getElementById("lottery").innerHTML=`\n        Joined lottery ${e.lotteryjoins.toLocaleString()} ${1==e.lotteryjoins?"time":"times"}<br>\n        Won lottery ${e.lotterywins} ${1==e.lotterywins?"time":"times"}`,document.getElementById("stocks").innerHTML=`\n        ${e.shungite} ${1==e.shungite?"share":"shares"} of ‚õ∞ shungite<br>\n        ${e.chicken} ${1==e.chicken?"share":"shares"} of üêî chicken<br>\n        ${e.bajcoin} ${1==e.bajcoin?"share":"shares"} of ‚õè bajcoin<br>\n        ${e.copium} ${1==e.copium?"share":"shares"} of ‚õΩüò∑ copium`,document.getElementById("trades").innerHTML=`\n        ${e.egsgiven.toLocaleString()} ${1==e.egsgiven?"eg":"egs"} sent<br>\n        ${e.egsreceived.toLocaleString()} ${1==e.egsreceived?"eg":"egs"} received<br>`}else document.getElementById("seasonTable").innerHTML=`Could not find ${e}'s stats`;if(n.userInfoAll){let e=n.userInfoAll;document.getElementById("eggAllTime").innerHTML=`\n        ${e.egs.toLocaleString()} ${1==e.egs?"eg":"egs"}<br>\n        +egs: ${e.plus.toLocaleString()}, 0egs: ${e.zero.toLocaleString()}, -egs: ${e.negative.toLocaleString()}<br>\n        ${e.egseaten.toLocaleString()} ${1==e.egseaten?"eg":"egs"} eaten`,document.getElementById("commandsAllTime").innerHTML=`\n        =eg used ${(e?.eguses||0).toLocaleString()} ${1==e?.eguses?"time":"times"}<br>\n        Other commands used ${e.uses.toLocaleString()} ${1==e.uses?"time":"times"}`,document.getElementById("coinflipAllTime").innerHTML=`\n        Played ${e.coinflips.toLocaleString()} ${1==e.coinflips?"time":"times"}<br>\n        Won ${e.coinflipwins} ${1==e.coinflipwins?"time":"times"} (${Math.round(e.coinflipwins/e.coinflips*100)||0}% win rate)<br>\n        Biggest win: ${e.biggestcoinflipwin} ${1==e.biggestcoinflipwin?"eg":"egs"}<br>\n        Biggest loss: ${e.biggestcoinfliploss} ${1==e.biggestcoinfliploss?"eg":"egs"}<br>`,document.getElementById("rouletteAllTime").innerHTML=`\n        Played ${e.roulettes.toLocaleString()} ${1==e.roulettes?"time":"times"}<br>\n        Won ${e.rouletteswon} ${1==e.rouletteswon?"time":"times"} (${Math.round(e.rouletteswon/e.roulettes*100)||0}% win rate)<br>\n        Biggest win: ${e.biggestroulettewin} ${1==e.biggestroulettewin?"eg":"egs"}<br>\n        Biggest loss: ${e.biggestrouletteloss} ${1==e.biggestrouletteloss?"eg":"egs"}<br>`,document.getElementById("duelsAllTime").innerHTML=`\n        Played ${e.duels.toLocaleString()} ${1==e.duels?"time":"times"}<br>\n        Won ${e.duelswon} ${1==e.duelswon?"time":"times"} (${Math.round(e.duelswon/e.duels*100)||0}% win rate)<br>\n        Biggest win: ${e.biggestduelwin} ${1==e.biggestduelwin?"eg":"egs"}<br>\n        Biggest loss: ${e.biggestduelloss} ${1==e.biggestduelloss?"eg":"egs"}<br>`,document.getElementById("lotteryAllTime").innerHTML=`\n        Joined lottery ${e.lotteryjoins.toLocaleString()} ${1==e.lotteryjoins?"time":"times"}<br>\n        Won lottery ${e.lotterywins} ${1==e.lotterywins?"time":"times"}`,document.getElementById("stocksAllTime").innerHTML=`\n        ${e.shungite} ${1==e.shungite?"share":"shares"} of ‚õ∞ shungite<br>\n        ${e.chicken} ${1==e.chicken?"share":"shares"} of üêî chicken<br>\n        ${e.bajcoin} ${1==e.bajcoin?"share":"shares"} of ‚õè bajcoin<br>\n        ${e.copium} ${1==e.copium?"share":"shares"} of ‚õΩüò∑ copium`,document.getElementById("tradesAllTime").innerHTML=`\n        ${e.egsgiven.toLocaleString()} ${1==e.egsgiven?"eg":"egs"} sent<br>\n        ${e.egsreceived.toLocaleString()} ${1==e.egsreceived?"eg":"egs"} received<br>`}else document.getElementById("allTimeTable").innerHTML=`Could not find ${e}'s all time stats`;if(n.nfes.length){let e="";for(let t=0,a=n.nfes.length;t<a;t++)e+=`\n          <div class="card nfe">\n          <img src="data:image/gif;base64,${n.nfes[t].image}" class="card-img-top" alt="NFE ${n.nfes[t]._id}" title="NFE ${n.nfes[t]._id}" />\n          <div class="card-body">\n          <h5 class="card-title">${n.nfes[t].rarity||"Unknown rarity"} NFE</h5>\n          <button type="button" class="btn btn-secondary" onclick="copyListCommand(${n.nfes[t]._id},event)">\n          <i class="material-icons notranslate">content_copy</i>Copy list command\n          </button>\n          </div>\n          </div>`;document.getElementById("nfe").innerHTML=`<div class="nfecontainer">${e}</div>`;for(let e=0;e<document.images.length;e++)document.images[e].alt.startsWith("NFE")&&document.images[e].addEventListener("contextmenu",(e=>(e.preventDefault(),alert("You think its funny to take screenshots of people's NFEs, huh? Property theft is a joke to you? I'll have you know that the egchain doesn't lie. I own it. Even if you save it, it's my property. You are mad that you don't own the art I own. Delete that screenshot."),!1)))}else document.getElementById("nfe").innerHTML=`${e} does not own any NFEs`}catch(t){document.getElementById("channelSettings").innerHTML=`Could not load ${e}'s channel settings :(`,document.getElementById("seasonTable").innerHTML=`Could not load ${e}'s stats :(`,document.getElementById("allTimeTable").innerHTML=`Could not load ${e}'s all time stats :(`,document.getElementById("nfe").innerHTML=`Could not load ${e}'s NFEs :(`,console.log(t)}}}async function getLeaderboard(){try{let e=await fetch("https://api.okayeg.com/leaderboard"),t=await e.json(),n=document.getElementById("seasonSelect");n.remove(0);for(let e=t.season;e>=0;e--){let a=document.createElement("option");a.value=e,a.text=`Season ${e}`,e==t.season&&(a.selected=!0),n.appendChild(a)}document.getElementById("season").innerHTML=`Season ${t.season} Leaderboard`,document.getElementById("endTime").innerHTML=`Ends in ${relativeTime(1e3*t.timeLeft)}`;for(let e=0;e<10;e++)document.getElementById(`user${e+1}`).innerHTML=`<a href="https://twitch.tv/${t.current[e].username}" target="_blank" rel="noopener noreferrer">\n      ${t.current[e].username}</a>`,document.getElementById(`user${e+1}PFP`).dataset.userid=t.current[e].id,document.getElementById(`user${e+1}Egs`).innerHTML=`${t.current[e].egs.toLocaleString()} egs`;await loadLBPFPs(),n.addEventListener("change",(async function(){document.getElementById("season").innerHTML=`Season ${n.value} Leaderboard`,document.getElementById("endTime").innerHTML=parseInt(n.value,10)===parseInt(t.season,10)?`Ends in ${relativeTime(1e3*t.timeLeft)}`:"";let e=t.allTime[0].leaderboard[n.value].users;parseInt(n.value,10)===parseInt(t.season,10)&&(e=t.current);for(let t=0;t<10;t++)document.getElementById(`user${t+1}`).innerHTML=`<a href="https://twitch.tv/${e[t].username}" target="_blank" rel="noopener noreferrer">\n        ${e[t].username}</a>`,document.getElementById(`user${t+1}PFP`).dataset.userid=e[t].id,document.getElementById(`user${t+1}Egs`).innerHTML=`${e[t].egs.toLocaleString()} egs`;document.getElementById("loadTop100").style.display="",document.getElementById("top100").style.display="none",await loadLBPFPs()})),document.getElementById("loadTop100").addEventListener("click",(function(){document.getElementById("loadTop100").style.display="none";let e=t.allTime[0].leaderboard[n.value].users;n.value==t.season&&(e=t.current);let a="";for(let t=10;t<100;t++)a+=`\n        <tr>\n        <th>${addOrdinalSuffix(t+1)} Place</th>\n        <td><a href="https://twitch.tv/${e[t].username}" target="_blank" rel="noopener noreferrer">\n        ${e[t].username}</a>\n        </td>\n        <td>${e[t].egs.toLocaleString()} egs</td>\n      </tr>`;document.getElementById("top100Table").innerHTML=a,document.getElementById("top100").style.display=""}))}catch(e){console.log("getLeaderboard error"+e)}}async function loadLBPFPs(){let e=document.querySelectorAll(".lb-pfp");e=[...e].map((e=>e.dataset.userid));let t=await fetch(`https://helper.donk.workers.dev/twitch/users?id=${e.join(",")}`),n=await t.json();for(let e=1;e<=10;e++){let t=n.data.find((t=>t.id===document.getElementById(`user${e}PFP`).dataset.userid))?.profile_image_url||"/pics/okayeg.png";document.getElementById(`user${e}PFP`).src=t}}async function reloadTwitchGlobal(){document.getElementById("twitch").innerHTML=spinner;try{let e=await fetch("https://helper.donk.workers.dev/twitch/chat/emotes/global"),t=await e.json();document.getElementById("twitch").innerHTML="";for(let e=0,n=t.data.length;e<n;e++)document.getElementById("twitch").innerHTML+=`\n      <div class="border border-secondary emote">\n      <img src="https://static-cdn.jtvnw.net/emoticons/v2/${t.data[e].id}/default/dark/3.0" loading="lazy" title="${t.data[e].name}" alt="${t.data[e].name}">\n      <div class="text-body-secondary text-center">${t.data[e].name}</div>\n      </div>`;document.getElementById("twitchCount").innerHTML=` (${t.data.length} emotes)`}catch(e){console.log("reloadTwitchGlobal error"+e)}}async function loadGlobalEmotes(){try{let e=await fetch("/data/globaltwitch.json"),t=await e.json();for(let e=0,n=t.data.length;e<n;e++)document.getElementById("twitch").innerHTML+=`<div class="border border-secondary emote">\n      <img src="https://static-cdn.jtvnw.net/emoticons/v2/${t.data[e].id}/default/dark/3.0" loading="lazy" title="${t.data[e].name}" alt="${t.data[e].name}">\n      <div class="text-body-secondary text-center">${t.data[e].name}</div>\n      </div>`;document.getElementById("twitchCount").innerHTML=` (${t.data.length} emotes)`;let n=await fetch("https://api.betterttv.net/3/cached/emotes/global"),a=await n.json();for(let e=0,t=a.length;e<t;e++)document.getElementById("bttv").innerHTML+=`<div class="border border-secondary emote">\n      <a href="https://betterttv.com/emotes/${a[e].id}" target="_blank" rel="noopener noreferrer"><img src="https://cdn.betterttv.net/emote/${a[e].id}/3x" loading="lazy" alt="${a[e].code}" title="${a[e].code}"></a>\n      <div class="text-body-secondary text-center">${a[e].code}</div>\n      </div>`;document.getElementById("bttvCount").innerHTML=` (${a.length} emotes)`;let o=await fetch("https://api.frankerfacez.com/v1/set/global"),r=await o.json();for(let e=0;e<r.default_sets.length;e++){let t=r.default_sets[e];for(let e=0,n=r.sets[t].emoticons.length;e<n;e++){let n=r.sets[t].emoticons[e],a=n.urls[4];n.animated&&(a=n.animated[4]),document.getElementById("ffz").innerHTML+=`<div class="border border-secondary emote">\n      <a href="https://www.frankerfacez.com/emoticon/${n.id}" target="_blank" rel="noopener noreferrer"><img src="${a}" loading="lazy" alt="${n.name}" title="${n.name}"></a>\n      <div class="text-body-secondary text-center">${n.name}</div>\n      </div>`}}document.getElementById("ffzCount").innerHTML=` (${r.sets[3].emoticons.length} emotes)`;let s=await fetch("https://7tv.io/v3/emote-sets/global"),i=await s.json();for(let e=0,t=i.emotes.length;e<t;e++){let t=i.emotes[e].data.host.files.filter((e=>"AVIF"==e.format));document.getElementById("7tv").innerHTML+=`<div class="border border-secondary emote">\n      <a href="https://7tv.app/emotes/${i.emotes[e].id}" target="_blank" rel="noopener noreferrer">\n      <img src="${i.emotes[e].data.host.url}/${t[3].name}" loading="lazy" alt="${i.emotes[e].name}" title="${i.emotes[e].name}"></a>\n      <div class="text-body-secondary text-center">${i.emotes[e].name}</div>\n      </div>`}document.getElementById("7tvCount").innerHTML=` (${i.length} emotes)`}catch(e){console.log("loadGlobalEmotes error",e)}}async function getTwitchUser(e){try{let t=await fetch(`https://helper.donk.workers.dev/twitch/users?login=${e}`),n=await t.json();return n?.data&&n?.data[0]?.id?n.data[0]:null}catch(e){return console.log("getTwitchUser error",e),null}}async function loadChannelEmotes(){let e="",t=location.hash.replace("#","").toLowerCase().replace(/\s/g,"");if(document.getElementById("channel").value?t=document.getElementById("channel").value.toLowerCase().replace(/\s/g,""):document.getElementById("channel").value=t,!t)return;let n=await getTwitchUser(t);if(!n)return document.getElementById("output").style.display="",document.getElementById("output").innerHTML='<h1 class="display-1 text-center">Channel not found</h1>',document.getElementById("twitch").innerHTML="",document.getElementById("badges").innerHTML="",document.getElementById("bttv").innerHTML="",document.getElementById("ffz").innerHTML="",void(document.getElementById("seventv").innerHTML="");document.getElementById("output").style.display="none",e=n.display_name.toLowerCase()==n.login?n.display_name:`${n.display_name} (${n.login})`,document.getElementById("twitch").innerHTML="",document.getElementById("badges").innerHTML="",document.getElementById("bttv").innerHTML="",document.getElementById("ffz").innerHTML="",document.getElementById("seventv").innerHTML="";try{let t=await fetch(`https://helper.donk.workers.dev/twitch/chat/emotes?broadcaster_id=${n.id}`),a=await t.json();if(a?.data?.length>0){a.data.sort(((e,t)=>e.name.localeCompare(t.name))),document.getElementById("twitch").innerHTML=`\n      <h1 class="display-1">\n        <a href="https://twitch.tv/${n.login}" target="_blank" rel="noopener noreferrer">${e}</a>'s Subscriber Emotes:\n      </h1>`;let t=0,o=0,r=0,s=0,i=0,l="",d="",c="",m="",g="";for(let e=0,n=a.data.length;e<n;e++)"1000"==a.data[e].tier&&(t++,l+=`\n          <div class="border border-secondary emote">\n            <img src="https://static-cdn.jtvnw.net/emoticons/v2/${a.data[e].id}/default/dark/3.0" loading="lazy" title="${a.data[e].name}" alt="${a.data[e].name}">\n            <div class="text-body-secondary emotetext text-center">${escapeString(a.data[e].name)}</div>\n          </div>`),"2000"==a.data[e].tier&&(o++,d+=`\n          <div class="border border-secondary emote">\n            <img src="https://static-cdn.jtvnw.net/emoticons/v2/${a.data[e].id}/default/dark/3.0" title="${a.data[e].name}" loading="lazy" alt="${a.data[e].name}">\n            <div class="text-body-secondary emotetext text-center">${escapeString(a.data[e].name)}</div>\n          </div>`),"3000"==a.data[e].tier&&(r++,c+=`\n          <div class="border border-secondary emote">\n            <img src="https://static-cdn.jtvnw.net/emoticons/v2/${a.data[e].id}/default/dark/3.0" title="${a.data[e].name}" loading="lazy" alt="${a.data[e].name}">\n            <div class="text-body-secondary emotetext text-center">${escapeString(a.data[e].name)}</div>\n          </div>`),"follower"==a.data[e].emote_type&&(s++,m+=`\n          <div class="border border-secondary emote">\n            <img  src="https://static-cdn.jtvnw.net/emoticons/v2/${a.data[e].id}/default/dark/3.0" title="${a.data[e].name}" loading="lazy" alt="${a.data[e].name}">\n            <div class="text-body-secondary emotetext text-center">${escapeString(a.data[e].name)}</div>\n          </div>`),"bitstier"==a.data[e].emote_type&&(i++,g+=`\n          <div class="border border-secondary emote">\n            <img src="https://static-cdn.jtvnw.net/emoticons/v2/${a.data[e].id}/default/dark/3.0" title="${a.data[e].name}" loading="lazy" alt="${a.data[e].name}">\n            <div class="text-body-secondary emotetext text-center">${escapeString(a.data[e].name)}</div>\n          </div>`);l&&(l=`\n        <h3>\n          Tier 1 Emotes <span class="text-body-secondary">(${t} ${1==t?"emote":"emotes"})</span>:\n        </h3>\n        <div class="emotecontainer">${l}</div>`),d&&(d=`\n        <h3>\n          Tier 2 Emotes <span class="text-body-secondary">(${o} ${1==o?"emote":"emotes"})</span>:\n        </h3>\n        <div class="emotecontainer">${d}</div>`),c&&(c=`\n        <h3>\n          Tier 3 Emotes <span class="text-body-secondary">(${r} ${1==r?"emote":"emotes"})</span>:\n        </h3>\n        <div class="emotecontainer">${c}</div>`),m&&(m=`\n        <h3>\n          Follower Emotes <span class="text-body-secondary">(${s} ${1==s?"emote":"emotes"})</span>:\n        </h3>\n        <div class="emotecontainer">${m}</div>`),g&&(g=`\n        <h3>\n          Bits Tier Emotes <span class="text-body-secondary">(${i} ${1==i?"emote":"emotes"})</span>:\n        </h3>\n        <div class="emotecontainer">${g}</div>`),document.getElementById("twitch").innerHTML+=l+d+c+m+g}}catch(e){console.log("twitch emotes error",e)}try{let e=await fetch(`https://helper.donk.workers.dev/twitch/chat/badges?broadcaster_id=${n.id}`),t=await e.json();if(t?.data?.length>0){let e=[],n=[];t?.data[0]?.versions?.length>0&&("subscriber"==t.data[0].set_id&&(e=t.data[0].versions),"bits"==t.data[0].set_id&&(n=t.data[0].versions)),t?.data[1]?.versions?.length>0&&("subscriber"==t.data[1].set_id&&(e=t.data[1].versions),"bits"==t.data[1].set_id&&(n=t.data[1].versions)),e.sort((function(e,t){return parseInt(e.id,10)-parseInt(t.id,10)})),n.sort((function(e,t){return parseInt(e.id,10)-parseInt(t.id,10)}));let a="",o="",r="",s="";for(let t=0,n=e.length;t<n;t++)e[t].id>=3e3?r+=`\n          <div class="border border-secondary emote">\n            <img src="${e[t].image_url_4x}" loading="lazy">\n            <div class="text-body-secondary text-center">${months[e[t].id]}</div>\n          </div>`:e[t].id>=2e3?o+=`\n          <div class="border border-secondary emote">\n            <img src="${e[t].image_url_4x}" loading="lazy">\n            <div class="text-body-secondary text-center">${months[e[t].id]}</div>\n          </div>`:a+=`\n          <div class="border border-secondary emote">\n            <img src="${e[t].image_url_4x}" loading="lazy">\n            <div class="text-body-secondary text-center">${months[e[t].id]}</div>\n          </div>`;for(let e=0,t=n.length;e<t;e++)s+=`\n        <div class="border border-secondary emote">\n          <img src="${n[e].image_url_4x}" loading="lazy">\n          <div class="text-body-secondary text-center">${escapeString(n[e].title)}</div>\n        </div>`;a&&(a=`<h3>Tier 1 Sub Badges:</h3><div class="emotecontainer">${a}</div>`),o&&(o=`<h3>Tier 2 Sub Badges:</h3><div class="emotecontainer">${o}</div>`),r&&(r=`<h3>Tier 3 Sub Badges:</h3><div class="emotecontainer">${r}</div>`),s&&(s=`<h3>Bit badges:</h3><div class="emotecontainer">${s}</div>`),document.getElementById("badges").innerHTML=a+o+r+s}}catch(e){console.log("twitch badges error",e)}try{let t=await fetch(`https://api.betterttv.net/3/cached/users/twitch/${n.id}`),a=await t.json();if(a?.channelEmotes?.length>0||a?.sharedEmotes?.length>0){let t="",o="";a.channelEmotes.sort(((e,t)=>e.code.localeCompare(t.code))),a.sharedEmotes.sort(((e,t)=>e.code.localeCompare(t.code))),document.getElementById("bttv").innerHTML=`\n      <h1 class="display-1">\n        <a href="https://betterttv.com/users/${a.id}" target="_blank" rel="noopener noreferrer">${e}</a>'s BTTV Emotes:\n      </h1>`;for(let e=0,n=a.channelEmotes.length;e<n;e++)t+=`\n        <div class="border border-secondary emote">\n          <a href="https://betterttv.com/emotes/${a.channelEmotes[e].id}" target="_blank" rel="noopener noreferrer">\n            <img src="https://cdn.betterttv.net/emote/${a.channelEmotes[e].id}/3x" loading="lazy" alt="${a.channelEmotes[e].code}" title="${a.channelEmotes[e].code}">\n          </a>\n          <div class="text-body-secondary emotetextwide text-center">${escapeString(a.channelEmotes[e].code)}</div>\n        </div>`;for(let e=0,t=a.sharedEmotes.length;e<t;e++)o+=`\n        <div class="border border-secondary emote">\n          <a href="https://betterttv.com/emotes/${a.sharedEmotes[e].id}" target="_blank" rel="noopener noreferrer">\n            <img src="https://cdn.betterttv.net/emote/${a.sharedEmotes[e].id}/3x" loading="lazy" alt="${a.sharedEmotes[e].code}" title="${a.sharedEmotes[e].code}">\n          </a>\n          <div class="text-body-secondary emotetextwide text-center">${escapeString(a.sharedEmotes[e].code)}</div>\n        </div>`;t&&(t=`\n        <h3>\n          BTTV channel emotes\n          <i class="material-icons notranslate" data-bs-toggle="tooltip" data-bs-title="Channel emotes are emotes that were uploaded to BTTV by ${n.login}.">info</i>\n          <span class="text-body-secondary">(${a.channelEmotes.length} ${1==a.channelEmotes.length?"emote":"emotes"})</span>:\n        </h3>\n        <div class="emotecontainer">${t}</div>`),o&&(o=`\n        <h3>\n          BTTV shared emotes\n          <i class="material-icons notranslate" data-bs-toggle="tooltip" data-bs-title="Shared emotes are emotes that were uploaded to BTTV by other users.">info</i>\n          <span class="text-body-secondary">(${a.sharedEmotes.length} ${1==a.channelEmotes.length?"emote":"emotes"})</span>:\n        </h3>\n        <div class="emotecontainer">${o}</div>`),document.getElementById("bttv").innerHTML+=t+o,enableTooltips()}}catch(e){console.log("bttv error",e)}try{let t=await fetch(`https://api.frankerfacez.com/v1/room/id/${n.id}`),a=await t.json();if(200==t.status&&a?.room?.set&&a.sets[a?.room?.set]?.emoticons?.length>0){let t="",o=a.room.set,r=a.sets[o];r.emoticons.sort(((e,t)=>e.name.localeCompare(t.name))),document.getElementById("ffz").innerHTML=`\n      <h1 class="display-1">\n        <a href="https://www.frankerfacez.com/channel/${n.login}" target="_blank" rel="noopener noreferrer">${e}</a>'s FFZ Emotes \n        <span class="text-body-secondary">(${r.emoticons.length} ${1==r.emoticons.length?"emote":"emotes"})</span>:\n      </h1>`;for(let e=0,n=r.emoticons.length;e<n;e++){let n=r.emoticons[e].urls[4];r.emoticons[e].animated&&(n=r.emoticons[e].animated[4]),t+=`\n        <div class="border border-secondary emote">\n          <a href="https://www.frankerfacez.com/emoticon/${r.emoticons[e].id}" target="_blank" rel="noopener noreferrer">\n            <img src="${n}" loading="lazy" alt="${r.emoticons[e].name}" title="${r.emoticons[e].name}">\n          </a>\n          <div class="text-body-secondary emotetextwide text-center">${escapeString(r.emoticons[e].name)}</div>\n        </div>`}t&&(t=`<div class="emotecontainer">${t}</div>`),document.getElementById("ffz").innerHTML+=t,a.room.mod_urls&&(document.getElementById("badges").innerHTML+=`\n        <h3>Mod badge:</h3>\n        <div class="emotecontainer">\n          <div class="border border-secondary emote">\n            <img src="${a.room.mod_urls[4]}" loading="lazy" alt="Mod badge" title="Mod badge">\n            <div class="text-body-secondary text-center">Mod badge</div>\n          </div>\n        </div>`),a.room.vip_badge&&(document.getElementById("badges").innerHTML+=`\n        <h3>VIP badge:</h3>\n        <div class="emotecontainer">\n          <div class="border border-secondary emote">\n            <img src="${a.room.vip_badge[4]}" loading="lazy" alt="VIP badge" title="VIP badge">\n            <div class="text-body-secondary text-center">VIP badge</div>\n          </div>\n        </div>`)}}catch(e){console.log("ffz error",e)}try{let t=await fetch(`https://7tv.io/v3/users/twitch/${n.id}`),a=await t.json();if(200==t.status&&a?.emote_set?.emotes?.length>0){a.emote_set.emotes.sort(((e,t)=>e.name.localeCompare(t.name)));let t="";document.getElementById("seventv").innerHTML=`\n      <h1 class="display-1">\n        <a href="https://7tv.app/users/${a.user.id}" target="_blank" rel="noopener noreferrer">${e}</a>'s 7TV Emotes \n        <span class="text-body-secondary">(${a.emote_set.emotes.length} ${1==a.emote_set.emotes.length?"emote":"emotes"})</span>:\n      </h1>`;for(let e=0,n=a.emote_set.emotes.length;e<n;e++){let n=a.emote_set.emotes[e].data.host.files.filter((e=>"AVIF"==e.format));t+=`\n        <div class="border border-secondary emote">\n          <a href="https://7tv.app/emotes/${a.emote_set.emotes[e].id}" target="_blank" rel="noopener noreferrer">\n            <img src="${a.emote_set.emotes[e].data.host.url}/${n[3].name}" loading="lazy" alt="${a.emote_set.emotes[e].name}" title="${a.emote_set.emotes[e].name}">\n          </a>\n          <div class="text-body-secondary emotetextwide text-center">${escapeString(a.emote_set.emotes[e].name)}</div>\n        </div>`}t&&(t=`<div class="emotecontainer">${t}</div>`),document.getElementById("seventv").innerHTML+=t}}catch(e){console.log("7tv error",e)}""==document.getElementById("twitch").innerHTML&&""==document.getElementById("badges").innerHTML&&""==document.getElementById("bttv").innerHTML&&""==document.getElementById("ffz").innerHTML&&""==document.getElementById("seventv").innerHTML&&(document.getElementById("output").style.display="",document.getElementById("output").innerHTML='<h1 class="display-1 text-center">Channel Has no emotes</h1>')}function enableTooltips(){[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map((e=>new bootstrap.Tooltip(e,{trigger:"hover"})))}async function loadFollowList(){let e=location.hash.replace("#","").toLowerCase().replace(/\s/g,"");if(document.getElementById("username").value?e=document.getElementById("username").value:document.getElementById("username").value=e,e){document.getElementById("title1").style.display="block",document.getElementById("listcontainer").style.display="block",document.getElementById("title1").innerHTML="",document.getElementById("list").innerHTML=spinner;try{let t=await fetch(`https://api.okayeg.com/followlist?username=${e}`);if(200!==t.status)return document.getElementById("title1").innerHTML=`<h1 class="display-1">\n        <a href="https://twitch.tv/${e}" target="_blank" rel="noopener noreferrer">${e}</a> was never looked up\n        </h1>`,void(document.getElementById("list").innerHTML="");let n=await t.json(),a=n.time,o=n.data.display_name.toLowerCase()==n.data.login?n.data.display_name:`${n.data.display_name} (${n.data.login})`;if(document.getElementById("list").innerHTML="",0==n.data.total)return void(document.getElementById("title1").innerHTML=`\n        <h1 class="display-1"><a href="https://twitch.tv/${n.data.login}" target="_blank" rel="noopener noreferrer">${o}</a> is not following anyone.</h1>\n        <div class="alert alert-warning" role="alert">Cached follow list from ${new Date(a).toISOString()}</div>`);let r=n.data.following;if(r.length>0){document.getElementById("title1").innerHTML=`\n        <h1 class="display-1"><a href="https://twitch.tv/${n.data.login}" target="_blank" rel="noopener noreferrer">${o}</a> is following ${n.data.total} people:</h1>\n        <div class="alert alert-warning" role="alert">Cached follow list from ${new Date(a).toISOString()} Use the <kbd>=optout followlist</kbd> command in OkayegBOT's chat to opt out</div>`;for(let e=0,t=r.length;e<t;e++){let t=n.data.following[e].display_name,a=t,o=n.data.following[e].login,r=n.data.following[e].profile_image_url?n.data.following[e].profile_image_url:"/pics/banned.png",s=n.data.following[e].broadcaster_type?n.data.following[e].broadcaster_type:"",i="staff"==n.data.following[e].type,l=n.data.following[e].description?n.data.following[e].description:"",d=n.data.following[e].followed_at?n.data.following[e].followed_at.replace("T"," ").replace("Z"," "):"";t.toLowerCase()!==o.toLowerCase()&&(a=`${o} (${t})`),document.getElementById("list").innerHTML+=`\n          <div class="border ${"/pics/banned.png"==r?"border-danger":"border-secondary"} emote">\n          <a href="https://twitch.tv/${o}" target="_blank" rel="noopener noreferrer"><img src="${r}" loading="lazy" title="${l}" alt="${t}">\n          <div class="text-body-secondary text-center">${a}${"partner"==s?svg:""}${i?staffpic:""}</div><div class="text-body-secondary text-center">Followed at: ${d}</div>\n          </div>`}}}catch(e){console.log("loadFollowList error",e)}}}let ctx="",myChart="";async function initGraph(){ctx=document.getElementById("chartCanvas").getContext("2d");let e=[],t=[],n=[],a=[],o=[];try{let r=await fetch("https://api.okayeg.com/stockhistory"),s=await r.json();for(let r=0,i=s.length;r<i;r++)"chicken"==s[r].stock?(e=[...e,...s[r].data.history],o=[...o,...s[r].data.historytime]):"shungite"==s[r].stock?t=[...t,...s[r].data.history]:"bajcoin"==s[r].stock?n=[...n,...s[r].data.history]:"copium"==s[r].stock&&(a=[...a,...s[r].data.history]);for(let e=0,t=o.length;e<t;e++)o[e]=new Date(1e3*o[e]).toISOString().replace("T"," ").replace("Z"," ");myChart=new Chart(ctx,{type:"line",data:{labels:o,datasets:[{label:"chicken",data:e,tension:.1,borderColor:"#4dc9f6",backgroundColor:"#4dc9f6"},{label:"shungite",data:t,tension:.1,borderColor:"#f67019",backgroundColor:"#f67019"},{label:"bajcoin",data:n,tension:.1,borderColor:"#f53794",backgroundColor:"#f53794"},{label:"copium",data:a,tension:.1,borderColor:"#0ea600",backgroundColor:"#0ea600"}]},options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"Okayegbot stock history"},tooltip:{enabled:!0},zoom:{pan:{enabled:!0},zoom:{wheel:{enabled:!0,modifierKey:"ctrl"},pinch:{enabled:!0}}}}}})}catch(e){console.log("initGraph error",e)}}function resetZoom(){myChart.resetZoom()}async function loadNFEMarket(){try{let e=location.hash.replace("#","").toLowerCase().replace(/\s/g,""),t=await fetch("https://api.okayeg.com/market"),n=await t.json(),a={Common:1,Rare:2,Epic:3,Legendary:4},o='<div class="row row-cols-1 row-cols-md-4 g-3" id="listingsRow">';for(let e=0;e<n.length;e++)o+=`\n      <div class="col nfe-card" data-price="${n[e].price}" data-rarity="${a[n[e].rarity]||5}">\n      <div class="card" id=${n[e]._id}>\n      <img src="data:image/gif;base64,${n[e].image}" class="card-img-top" alt="NFE ${n[e]._id}" title="NFE ${n[e]._id}" />\n      <div class="card-body">\n        <h5 class="card-title">${n[e].price.toLocaleString()} ${1==n[e].price?"eg":"egs"}</h5>\n        <p class="card-text">${n[e].rarity||"Unknown rarity"} NFE listed by \n        <a href="https://twitch.tv/${n[e].ownerusername}" target="_blank" rel="noopener noreferrer">${n[e].ownerusername}</a></p>\n        <button type="button" class="btn btn-secondary" onclick="copyBuyCommand(${n[e]._id},event)"><i class="material-icons notranslate">content_copy</i>Copy buy command</button>\n      </div>\n      </div>\n      </div>`;if(document.getElementById("listings").innerHTML=o+"</div>",document.getElementById(e)){document.getElementById(e).scrollIntoView(),document.getElementById(e).classList.add("border-info");let t=setInterval((()=>{document.getElementById(e).classList.toggle("border-info")}),200);setTimeout((()=>{clearInterval(t),document.getElementById(e).classList.remove("border-info")}),2e3)}document.getElementById("sort").addEventListener("change",(async function(){let e=document.querySelectorAll(".nfe-card"),t=Array.from(e).sort(((e,t)=>{switch(this.value){case"priceHighest":return parseInt(t.dataset.price,10)-parseInt(e.dataset.price,10);case"priceLowest":return parseInt(e.dataset.price,10)-parseInt(t.dataset.price,10);case"rarityHighest":return parseInt(t.dataset.rarity,10)-parseInt(e.dataset.rarity,10);case"rarityLowest":return parseInt(e.dataset.rarity,10)-parseInt(t.dataset.rarity,10);default:break}}));document.getElementById("listingsRow").innerHTML="";for(let e=0;e<t.length;e++)document.getElementById("listingsRow").appendChild(t[e])}))}catch(e){console.log("loadNFEMarket error",e)}}function copyBuyCommand(e,t){navigator.clipboard.writeText(`=nfe buy ${e}`),t.target.innerHTML="Command copied :)",setTimeout((()=>{t.target.innerHTML='<i class="material-icons notranslate">content_copy</i>Copy buy command'}),2e3)}function copyListCommand(e,t){navigator.clipboard.writeText(`=nfe list ${e} [price]`),t.target.innerHTML="Command copied :)",setTimeout((()=>{t.target.innerHTML='<i class="material-icons notranslate">content_copy</i>Copy list command'}),2e3)}async function loadClips(){try{let e=await fetch("https://api.okayeg.com/clips"),t=await e.json(),n=t.clips,a=t.games,o="";for(let e=0,t=n.length;e<t;e++)o+=`<div class="card clipcard">\n            <div class="card-body">\n                <div class="row">\n                    <div class="col-xl-5">\n                    <a href="${n[e].url}" target="_blank" rel="noopener noreferrer"><img src="${n[e].thumbnail_url}" alt="clip thumbnail" height="272" width="480"></a>\n                    </div>\n                    <div class="col-xl-7">\n                        Title: ${n[e].title}<br>\n                        Category: ${a.find((t=>t.id===n[e].game_id))?.name||"ü§∑"}<br>\n                        Channel: <a href="https://twitch.tv/${n[e].broadcaster_name}" target="_blank" rel="noopener noreferrer">${n[e].broadcaster_name}</a><br>\n                        View count: ${n[e].view_count.toLocaleString()}<br>\n                        Created at: ${new Date(n[e].created_at).toUTCString()}<br>\n                        Clipped by: <a href="https://twitch.tv/${n[e].creator_name}" target="_blank" rel="noopener noreferrer">${n[e].creator_name}</a><br>\n                        Language: ${getLanguage(n[e].language||"en")}<br>\n                        Duration: ${n[e].duration}<br>\n                        URL: <a href="${n[e].url}" target="_blank" rel="noopener noreferrer">${n[e].url}</a><br>\n                    </div>\n                </div>\n            </div>\n        </div>`;document.getElementById("clipsdiv").innerHTML=`<h3>Top ${n.length} clips from ${a[100].startdate} to ${a[101].enddate}</h3>\n        Clips are collected by fetching the top 100 games on twitch every hour during the week then fetching the top 20 clips in the games that were in the list of top 100 games the most throughout the week.\n        ${o}`}catch(e){console.log("loadClips error",e)}}async function loadEmbedStream(){let e=$("#streamCommands").DataTable({responsive:!0,retrieve:!0,paging:!1,scrollCollapse:!0,searching:!1,info:!1,columns:[{width:"20%"},{width:"80%"}],language:{emptyTable:'ladink... <img src="/pics/okayeg.png" alt="okayeg" style="height:2em;"> '}});try{let t=await fetch("https://api.okayeg.com/commands"),n=await t.json();for(let t=0;t<n.length;t++){let a=n[t].aliases.map((e=>"="+e)).join(", ").replaceAll("=+","+"),o=`${n[t].desc}\n      ${1==n[t].whisperable?"<br><span class='text-body-secondary'>Whisperable</span>":""}\n      ${0==n[t].enabled?"<br><span class='text-warning'>Currently disabled</span>":""}`,r=`=${n[t]._id}\n      ${a?"<br><small class='text-body-secondary'>Alias: "+a+"</small>":""}`;5==n[t].cat&&e.row.add([r,o]).draw(!1)}}catch(e){console.log(e)}new Twitch.Embed("twitch-embed",{width:"100%",height:"900px",channel:"okayegbot",parent:["okayeg.com"]})}async function loadCommands(){let e=$("#table1").DataTable({autoWidth:!1,responsive:!0,retrieve:!0,paging:!1,scrollCollapse:!0,searching:!1,info:!1,columns:[{width:"20%"},{width:"80%"}],language:{emptyTable:'ladink... <img src="/pics/okayeg.png" alt="okayeg" style="height:2em;"> '}}),t=$("#table2").DataTable({responsive:!0,retrieve:!0,paging:!1,scrollCollapse:!0,searching:!1,info:!1,columns:[{width:"20%"},{width:"80%"}],language:{emptyTable:'ladink... <img src="/pics/okayeg.png" alt="okayeg" style="height:2em;"> '}}),n=$("#table3").DataTable({responsive:!0,retrieve:!0,paging:!1,scrollCollapse:!0,searching:!1,info:!1,columns:[{width:"20%"},{width:"80%"}],language:{emptyTable:'ladink... <img src="/pics/okayeg.png" alt="okayeg" style="height:2em;"> '}}),a=$("#table4").DataTable({responsive:!0,retrieve:!0,paging:!1,scrollCollapse:!0,searching:!1,info:!1,columns:[{width:"20%"},{width:"80%"}],language:{emptyTable:'ladink... <img src="/pics/okayeg.png" alt="okayeg" style="height:2em;"> '}}),o=$("#table6").DataTable({responsive:!0,retrieve:!0,paging:!1,scrollCollapse:!0,searching:!1,info:!1,columns:[{width:"20%"},{width:"80%"}],language:{emptyTable:'ladink... <img src="/pics/okayeg.png" alt="okayeg" style="height:2em;"> '}});try{let e=await fetch("https://api.okayeg.com/commands"),t=await e.json();for(let e=0;e<t.length;e++){let n=t[e].aliases.map((e=>"="+e)).join(", ").replaceAll("=+","+"),a=`${t[e].desc}\n      ${1==t[e].whisperable?"<br><span class='text-body-secondary'>Whisperable</span>":""}\n      ${0==t[e].enabled?"<br><span class='text-warning'>Currently disabled</span>":""}`;r(`=${t[e]._id}\n      ${n?"<br><small class='text-body-secondary'>Alias: "+n+"</small>":""}`,a,t[e].cat)}}catch(e){console.log(e)}function r(r,s,i){switch(i){case 1:e.row.add([r,s]).draw(!1);break;case 2:t.row.add([r,s]).draw(!1);break;case 3:n.row.add([r,s]).draw(!1);break;case 4:a.row.add([r,s]).draw(!1);break;case 6:o.row.add([r,s]).draw(!1);break}}}async function loadStats(){try{let t=await fetch("https://api.okayeg.com/donkstats"),n=await t.json();const a={labels:["Partners","Affiliates","Others"],datasets:[{label:"Channels",data:[n.partners,n.affiliates,n.live-n.partners-n.affiliates],backgroundColor:["rgba(191, 148, 255, 0.8)","rgba(30, 130, 50, 0.8)","rgba(38, 80, 158, 0.8)"],borderColor:["rgba(191, 148, 255, 1)","rgba(30, 130, 50, 1)","rgba(38, 80, 158, 1)"],borderWidth:1}]},o={labels:["Partners","Affiliates","Others"],datasets:[{label:"Channels",data:[n.partner_viewers,n.affiliate_viewers,n.viewers-n.partner_viewers-n.affiliate_viewers],backgroundColor:["rgba(191, 148, 255, 0.8)","rgba(30, 130, 50, 0.8)","rgba(38, 80, 158, 0.8)"],borderColor:["rgba(191, 148, 255, 1)","rgba(30, 130, 50, 1)","rgba(38, 80, 158, 1)"],borderWidth:1}]},r={labels:[">10,000 viewers","2,000 ‚Üí 10,000 viewers","1,000 ‚Üí 2,000 viewers","500 ‚Üí 1,000 viewers","200 ‚Üí 500 viewers","100 ‚Üí 200 viewers","10 ‚Üí 100 viewers","5 ‚Üí 10 viewers","1 ‚Üí 5 viewers","1 viewer","0 viewers"],datasets:[{label:"Channels",data:[n.tenthousand,n.twothousand_tenthousand,n.thousand_twothousand,n.fivehundred_thousand,n.twohundred_fivehundred,n.hundred_twohundred,n.ten_hundred,n.five_ten,n.one_five,n.one,n.zero],backgroundColor:["rgba(165, 0, 38, 0.8)","rgba(215, 48, 39, 0.8)","rgba(244, 109, 67, 0.8)","rgba(253, 174, 97, 0.8)","rgba(254, 224, 139, 0.8)","rgba(255, 255, 191, 0.8)","rgba(217, 239, 139, 0.8)","rgba(166, 217, 106, 0.8)","rgba(102, 189, 99, 0.8)","rgba(26, 152, 80, 0.8)","rgba(0, 104, 55, 0.8)"],borderColor:["rgba(165, 0, 38, 1)","rgba(215, 48, 39, 1)","rgba(244, 109, 67, 1)","rgba(253, 174, 97, 1)","rgba(254, 224, 139, 1)","rgba(255, 255, 191, 1)","rgba(217, 239, 139, 1)","rgba(166, 217, 106, 1)","rgba(102, 189, 99, 1)","rgba(26, 152, 80, 1)","rgba(0, 104, 55, 1)"],borderWidth:1}]},s={type:"pie",data:a,plugins:[ChartDataLabels],options:{plugins:{datalabels:{backgroundColor:function(e){return e.dataset.backgroundColor},borderColor:"white",borderRadius:25,borderWidth:1,color:"white",display:!0,font:{weight:"bold"},formatter:(e,t)=>`${t.chart.data.labels[t.dataIndex]}: ${e.toLocaleString()} (${roundToTwo(e/n.live*100)}%)`},legend:{display:!1},tooltip:{enabled:!1}}}},i={type:"pie",data:o,plugins:[ChartDataLabels],options:{plugins:{datalabels:{backgroundColor:function(e){return e.dataset.backgroundColor},borderColor:"white",borderRadius:25,borderWidth:1,color:"white",display:!0,font:{weight:"bold"},formatter:(e,t)=>`${t.chart.data.labels[t.dataIndex]}: ${e.toLocaleString()} (${roundToTwo(e/n.viewers*100)}%)`},legend:{display:!1},tooltip:{enabled:!1}}}},l={type:"bar",data:r,options:{plugins:{legend:{display:!1}},scales:{x:{display:!0},y:{display:!0,type:"logarithmic"}}}};for(let e of document.getElementsByClassName("spinner-border"))e.style.display="none";new Chart(document.getElementById("channelsChart"),s),new Chart(document.getElementById("viewersChart"),i),new Chart(document.getElementById("segmentsChart"),l);document.getElementById("totalChannels").innerHTML=`${n.live.toLocaleString()}`,document.getElementById("totalViewers").innerHTML=`${n.viewers.toLocaleString()}`,document.getElementById("totalGames").innerHTML=`${n.sum_games.toLocaleString()}`,document.getElementById("partners").innerHTML=`${n.partners.toLocaleString()} \n    <br>Partners make up only ${roundToTwo(n.partners/n.live*100)}% of streamers but have ${roundToTwo(n.partner_viewers/n.viewers*100)}% (${n.partner_viewers.toLocaleString()}) of all viewers`,document.getElementById("affiliates").innerHTML=`${n.affiliates.toLocaleString()} \n    <br>Affiliates make up ${roundToTwo(n.affiliates/n.live*100)}% of streamers and have ${roundToTwo(n.affiliate_viewers/n.viewers*100)}% (${n.affiliate_viewers.toLocaleString()}) of all viewers`,document.getElementById("others").innerHTML=`${(n.live-n.partners-n.affiliates).toLocaleString()} \n    <br>Others make up ${roundToTwo((n.live-n.partners-n.affiliates)/n.live*100)}% of streamers and have ${roundToTwo((n.viewers-n.partner_viewers-n.affiliate_viewers)/n.viewers*100)}% (${(n.viewers-n.partner_viewers-n.affiliate_viewers).toLocaleString()}) of all viewers`,document.getElementById("zero").innerHTML=`${n.zero.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.zero/n.live*100)}%)</span>`,document.getElementById("one").innerHTML=`${n.one.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.one/n.live*100)}%)</span>`,document.getElementById("one_five").innerHTML=`${n.one_five.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.one_five/n.live*100)}%)</span>`,document.getElementById("five_ten").innerHTML=`${n.five_ten.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.five_ten/n.live*100)}%)</span>`,document.getElementById("ten_hundred").innerHTML=`${n.ten_hundred.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.ten_hundred/n.live*100)}%)</span>`,document.getElementById("hundred_twohundred").innerHTML=`${n.hundred_twohundred.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.hundred_twohundred/n.live*100)}%)</span>`,document.getElementById("twohundred_fivehundred").innerHTML=`${n.twohundred_fivehundred.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.twohundred_fivehundred/n.live*100)}%)</span>`,document.getElementById("fivehundred_thousand").innerHTML=`${n.fivehundred_thousand.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.fivehundred_thousand/n.live*100)}%)</span>`,document.getElementById("thousand_twothousand").innerHTML=`${n.thousand_twothousand.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.thousand_twothousand/n.live*100)}%)</span>`,document.getElementById("twothousand_tenthousand").innerHTML=`${n.twothousand_tenthousand.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.twothousand_tenthousand/n.live*100)}%)</span>`,document.getElementById("tenthousand").innerHTML=`${n.tenthousand.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.tenthousand/n.live*100)}%)</span>`,document.getElementById("avg_viewcount").innerHTML=roundToTwo(n.viewers/n.live).toLocaleString(),document.getElementById("median_viewcount").innerHTML=roundToTwo(n.medianviewers).toLocaleString(),document.getElementById("avg_uptime").innerHTML=convertTime(n.avguptime),document.getElementById("median_uptime").innerHTML=convertTime(n.medianuptime);for(let e=0;e<10;e++)document.getElementById(`lang${e}`).innerHTML=getLanguage(n.languages[e]._id),document.getElementById(`lang${e}_channels`).innerHTML=`${n.languages[e].count.toLocaleString()}\n      <span class="text-body-secondary">(${roundToTwo(n.languages[e].count/n.live*100)}%)</span>`,document.getElementById(`lang${e}_avg`).innerHTML=n.languages[e].avg_viewers,document.getElementById(`lang${e}_max`).innerHTML=n.languages[e].max_viewers.toLocaleString();loadStats.load100Langs=function(){let e="";for(let t=10;t<n.languages.length;t++)e+=`<div class="row">\n          <div class="col align-self-center">\n          ${getLanguage(n.languages[t]._id)}\n          </div>\n          <div class="col align-self-start">\n          ${n.languages[t].count.toLocaleString()}\n          <span class="text-body-secondary">(${roundToTwo(n.languages[t].count/n.live*100)}%)</span>\n          </div>\n          <div class="col align-self-start">\n          ${n.languages[t].avg_viewers}\n          </div>\n          <div class="col align-self-start">\n          ${n.languages[t].max_viewers.toLocaleString()}\n          </div>\n        </div>`;document.getElementById("langDiv").innerHTML+=e,document.getElementById("load100Langs").style.display="none",document.getElementById("langHeader").innerHTML="Top languages"};for(let e=0;e<10;e++)document.getElementById(`tag${e}`).innerHTML=n.top_tags[e].tag,document.getElementById(`tag${e}_channels`).innerHTML=`${n.top_tags[e].channels.toLocaleString()}\n      <span class="text-body-secondary">(${roundToTwo(n.top_tags[e].channels/n.live*100)}%)</span>`,document.getElementById(`tag${e}_avg`).innerHTML=roundToTwo(n.top_tags[e].viewers/n.top_tags[e].channels).toLocaleString();loadStats.load100Tags=function(){let e="";for(let t=10;t<100;t++)e+=`\n          <div class="row">\n            <div class="col align-self-center">\n            ${n.top_tags[t].tag}\n             </div>\n            <div class="col align-self-start">\n            ${n.top_tags[t].channels.toLocaleString()}\n            <span class="text-body-secondary">(${roundToTwo(n.top_tags[t].channels/n.live*100)}%)</span>\n            </div>\n            <div class="col align-self-start">\n            <span class="placeholder-wave">${roundToTwo(n.top_tags[t].viewers/n.top_tags[t].channels).toLocaleString()}</span>\n          </div>\n          </div>`;document.getElementById("tagsDiv").innerHTML+=e,document.getElementById("load100Tags").style.display="none",document.getElementById("tagCount").innerHTML="100"},document.getElementById("total_tags").innerHTML=`${n.total_tags.toLocaleString()}`,document.getElementById("sum_tags").innerHTML=roundToTwo(n.sum_tags/n.live),document.getElementById("defaultpfp").innerHTML=`${n.defaultpfp.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.defaultpfp/n.live*100)}%)</span>`,document.getElementById("nodesc").innerHTML=`${n.nodesc.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.nodesc/n.live*100)}%)</span>`,document.getElementById("notitle").innerHTML=`${n.notitle.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.notitle/n.live*100)}%)</span>`,document.getElementById("nogame").innerHTML=`${n.nogame.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.nogame/n.live*100)}%)</span>`,document.getElementById("drops").innerHTML=`${n.drops.toLocaleString()} \n    <span class="text-body-secondary">(${roundToTwo(n.drops/n.live*100)}%)</span>`,document.getElementById("ccl_DrugsIntoxication").innerHTML=`\n    ${n.ccls.DrugsIntoxication.channels.toLocaleString()} channels\n    <span class="text-body-secondary">(${roundToTwo(n.ccls.DrugsIntoxication.channels/n.live*100)}%)</span> - \n    Average view count: ${roundToTwo(n.ccls.DrugsIntoxication.viewers/n.ccls.DrugsIntoxication.channels).toLocaleString()}`,document.getElementById("ccl_Gambling").innerHTML=`\n    ${n.ccls.Gambling.channels.toLocaleString()} channels\n    <span class="text-body-secondary">(${roundToTwo(n.ccls.Gambling.channels/n.live*100)}%)</span> - \n    Average view count: ${roundToTwo(n.ccls.Gambling.viewers/n.ccls.Gambling.channels).toLocaleString()}`,document.getElementById("ccl_MatureGame").innerHTML=`\n    ${n.ccls.MatureGame.channels.toLocaleString()} channels\n    <span class="text-body-secondary">(${roundToTwo(n.ccls.MatureGame.channels/n.live*100)}%)</span> - \n    Average view count: ${roundToTwo(n.ccls.MatureGame.viewers/n.ccls.MatureGame.channels).toLocaleString()}`,document.getElementById("ccl_ProfanityVulgarity").innerHTML=`\n    ${n.ccls.ProfanityVulgarity.channels.toLocaleString()} channels\n    <span class="text-body-secondary">(${roundToTwo(n.ccls.ProfanityVulgarity.channels/n.live*100)}%)</span> - \n    Average view count: ${roundToTwo(n.ccls.ProfanityVulgarity.viewers/n.ccls.ProfanityVulgarity.channels).toLocaleString()}`,document.getElementById("ccl_SexualThemes").innerHTML=`\n    ${n.ccls.SexualThemes.channels.toLocaleString()} channels\n    <span class="text-body-secondary">(${roundToTwo(n.ccls.SexualThemes.channels/n.live*100)}%)</span> - \n    Average view count: ${roundToTwo(n.ccls.SexualThemes.viewers/n.ccls.SexualThemes.channels).toLocaleString()}`,document.getElementById("ccl_ViolentGraphic").innerHTML=`\n    ${n.ccls.ViolentGraphic.channels.toLocaleString()} channels\n    <span class="text-body-secondary">(${roundToTwo(n.ccls.ViolentGraphic.channels/n.live*100)}%)</span> - \n    Average view count: ${roundToTwo(n.ccls.ViolentGraphic.viewers/n.ccls.ViolentGraphic.channels).toLocaleString()}`,document.getElementById("oldest_user").innerHTML=`\n    <div class="container-fluid">\n    <div class="row">\n      <div class="col-md-4">\n      <a href="https://twitch.tv/${n.oldest_user.username}" target="_blank" rel="noopener noreferrer">\n        <img src="${n.oldest_user.profile_image_url}" class="img-fluid rounded-start donkstats-pfp" title="${n.oldest_user.display_name}" alt="${n.oldest_user.display_name}"></a>\n      </div>\n      <div class="col">\n        <div class="card-body">\n          <h5 class="card-title"><a href="https://twitch.tv/${n.oldest_user.username}" target="_blank" rel="noopener noreferrer">${n.oldest_user.username==n.oldest_user.display_name.toLowerCase()?` ${n.oldest_user.display_name}`:` ${n.oldest_user.display_name} (${n.oldest_user.username})`}${"partner"==n.oldest_user.broadcaster_type?svg:""}${"staff"==n.oldest_user.type?staffpic:""}</a></h5>\n          <p class="card-text">\n          Account created ${relativeTime(Date.now()-n.oldest_user.age_timestamp)} ago <span class="text-body-secondary">(${new Date(n.oldest_user.age_timestamp).toISOString().replace("T"," ").replace("Z","")})</span> <br>\n          ${n.oldest_user.game_name||"<span class='text-body-secondary'>No category</span>"} ‚Ä¢ ${n.oldest_user.viewers.toLocaleString()} ${1==n.oldest_user.viewers?"Viewer":"Viewers"}\n          </p>\n        </div>\n      </div>\n    </div>\n  </div>`,document.getElementById("newest_user").innerHTML=`\n  <div class="container-fluid">\n  <div class="row">\n    <div class="col-md-4">\n    <a href="https://twitch.tv/${n.newest_user.username}" target="_blank" rel="noopener noreferrer">\n      <img src="${n.newest_user.profile_image_url}" class="img-fluid rounded-start donkstats-pfp" title="${n.newest_user.display_name}" alt="${n.newest_user.display_name}"></a>\n    </div>\n    <div class="col">\n      <div class="card-body">\n        <h5 class="card-title"><a href="https://twitch.tv/${n.newest_user.username}" target="_blank" rel="noopener noreferrer">${n.newest_user.username==n.newest_user.display_name.toLowerCase()?` ${n.newest_user.display_name}`:` ${n.newest_user.display_name} (${n.newest_user.username})`}${"partner"==n.newest_user.broadcaster_type?svg:""}${"staff"==n.newest_user.type?staffpic:""}</a></h5>\n        <p class="card-text">\n        Account created ${relativeTime(Date.now()-n.newest_user.age_timestamp)} ago <span class=text-body-secondary>(${new Date(n.newest_user.age_timestamp).toISOString().replace("T"," ").replace("Z","")})</span><br>\n        ${n.newest_user.game_name||"<span class='text-body-secondary'>No category</span>"} ‚Ä¢ ${n.newest_user.viewers.toLocaleString()} ${1==n.newest_user.viewers?"Viewer":"Viewers"}\n        </p>\n      </div>\n    </div>\n  </div>\n</div>`;let d=await checkPic(`https://static-cdn.jtvnw.net/ttv-boxart/${n.most_streamed.id}-285x380.jpg`);document.getElementById("most_streamed_img").src=`https://static-cdn.jtvnw.net/ttv-boxart/${n.most_streamed.id}${d?"":"_IGDB"}-285x380.jpg`,document.getElementById("most_streamed_img").title=n.most_streamed.name,document.getElementById("most_streamed_img").alt=n.most_streamed.name,document.getElementById("most_streamed").innerHTML=`\n    <h5 class="card-title">\n    <a href="https://www.twitch.tv/directory/game/${encodeURIComponent(n.most_streamed.name)}" target="_blank" rel="noopener noreferrer">${n.most_streamed.name}</a>\n    </h5>\n    <p class="card-text">\n    ${n.most_streamed.viewers.toLocaleString()} Viewers <span class="text-body-secondary">(${roundToTwo(n.most_streamed.viewers/n.viewers*100)}%)</span><br>\n    ${n.most_streamed.channels.toLocaleString()} Live Channels <span class="text-body-secondary">(${roundToTwo(n.most_streamed.channels/n.live*100)}%)</span><br>\n    </p>`;let c=await checkPic(`https://static-cdn.jtvnw.net/ttv-boxart/${n.highest_ratio.id}-285x380.jpg`);async function e(e="random"){let t;switch(e){case"next":t=parseInt(document.getElementById("least_popular").dataset.index,10),t++;break;case"back":t=parseInt(document.getElementById("least_popular").dataset.index,10),t--;break;default:t=Math.floor(Math.random()*n.least_popular.length)}document.getElementById("least_popular").dataset.index=t;let a=n.least_popular[t%n.least_popular.length],o=await checkPic(`https://static-cdn.jtvnw.net/ttv-boxart/${a.game_id}-285x380.jpg`);document.getElementById("least_popular_img").src=`https://static-cdn.jtvnw.net/ttv-boxart/${a.game_id}${o?"":"_IGDB"}-285x380.jpg`,document.getElementById("least_popular_img").title=n.least_popular.name,document.getElementById("least_popular_img").alt=n.least_popular.name,document.getElementById("least_popular").innerHTML=`\n      <h4 class="card-title">\n      <a href="https://www.twitch.tv/directory/game/${encodeURIComponent(a.game_name)}" target="_blank" rel="noopener noreferrer">${a.game_name}</a>\n      </h4>\n      <p class="card-text text-body-secondary">\n      Multiple categories (${n.least_popular.length}) meet this condition, use the buttons below to see more categories\n      </p>\n      <div class="btn-group float-end" role="group" aria-label="least popular categories browser">\n          <button type="button" onclick="loadStats.load_least_popular('back')" class="btn btn-secondary"><i class="material-icons notranslate">arrow_back</i></button>\n          <button type="button" onclick="loadStats.load_least_popular('next')" class="btn btn-secondary"><i class="material-icons notranslate">arrow_forward</i></button>\n      </div>`}document.getElementById("highest_ratio_img").src=`https://static-cdn.jtvnw.net/ttv-boxart/${n.highest_ratio.id}${c?"":"_IGDB"}-285x380.jpg`,document.getElementById("highest_ratio_img").title=n.highest_ratio.name,document.getElementById("highest_ratio_img").alt=n.highest_ratio.name,document.getElementById("highest_ratio").innerHTML=`\n    <h5 class="card-title">\n    <a href="https://www.twitch.tv/directory/game/${encodeURIComponent(n.highest_ratio.name)}" target="_blank" rel="noopener noreferrer">${n.highest_ratio.name}</a>\n    </h5>\n    <p class="card-text">\n    Only ${n.highest_ratio.channels} live ${1==n.highest_ratio.channels?"channel":"channels"} with a total of ${n.highest_ratio.viewers.toLocaleString()} viewers</p>`,e(),loadStats.load_least_popular=e,document.getElementById("info").innerHTML=`Stats updated on ${new Date(n.time)}`,Date.now()-n.time>72e5&&(document.getElementById("outdatedWarningText").innerHTML=`Stats are outdated, last update on ${new Date(n.time)}. Try refreshing or contacting me :)`,document.getElementById("outdatedWarning").style.display="")}catch(e){console.log(e)}enableTooltips()}function roundToTwo(e){return+(Math.round(e+"e+2")+"e-2")}function convertTime(e){let t=(new Date-e)/1e3;return new Date(1e3*t).toISOString().substr(11,8)}function convertTime2(e){let t=(Date.now()-e)/1e3,n=Number(t),a=Math.floor(n/86400),o=Math.floor(n%86400/3600),r=Math.floor(n%3600/60),s=Math.floor(n%60),i=a>0?a+(1==a?" day, ":" days, "):"",l=o>0?o+(1==o?" hour, ":" hours, "):"",d=r>0?r+(1==r?" minute, ":" minutes, "):"",c=s>0?s+(1==s?" second":" seconds"):"";return a>=1?i+l.slice(0,-2):o>=1?i+l+d.slice(0,-2):i+l+d+c}function getLanguage(e){return new Intl.DisplayNames(["en"],{type:"language"}).of(e)}async function checkPic(e){return(await fetch(e)).url==e}function relativeTime(e){let t="";const n=Intl.NumberFormat("en",{style:"unit",unit:"second",unitDisplay:"long"}).format,a=Intl.NumberFormat("en",{style:"unit",unit:"minute",unitDisplay:"long"}).format,o=Intl.NumberFormat("en",{style:"unit",unit:"hour",unitDisplay:"long"}).format,r=Intl.NumberFormat("en",{style:"unit",unit:"day",unitDisplay:"long"}).format,s=Intl.NumberFormat("en",{style:"unit",unit:"month",unitDisplay:"long"}).format,i=Intl.NumberFormat("en",{style:"unit",unit:"year",unitDisplay:"long"}).format;let l=31536e6,d=2628e6,c=864e5,m=36e5,g=6e4,u=1e3;if(e>=l){let n=Math.floor(e/l);t+=`${i(n)} `,e-=n*l}if(e>=d){let n=Math.floor(e/d);t+=`${s(n)} `,e-=n*d}if(e>=c){let n=Math.floor(e/c);t+=`${r(n)} `,e-=n*c}if(e>=m){let n=Math.floor(e/m);t+=`${o(n)} `,e-=n*m}if(e>=g){let n=Math.floor(e/g);t+=`${a(n)} `,e-=n*g}if(e>=u){let a=Math.floor(e/u);t+=`${n(a)} `,e-=a*u}return t}async function loadUserInfo(){let e=location.hash.replace("#","").toLowerCase().replace(/\s/g,"");if(document.getElementById("username").value?e=document.getElementById("username").value.toLowerCase().replace(/\s/g,""):document.getElementById("username").value=e,e){document.getElementById("output").innerHTML=spinner,document.getElementById("info").style.display="";try{let t=await fetch(`https://helper.donk.workers.dev/twitch/users?login=${e}`),n=await t.json();if(n?.data[0]?.id){document.getElementById("output").innerHTML="",document.getElementById("name").innerHTML=`<a href="https://twitch.tv/${n.data[0].login}" id="linkText" target="_blank" rel="noopener noreferrer">${n.data[0].display_name}</a>'s Info`,document.getElementById("userid").innerHTML=n.data[0].id,document.getElementById("login").innerHTML=n.data[0].login,document.getElementById("displayname").innerHTML=n.data[0].display_name,document.getElementById("usertype").innerHTML=n.data[0].type||'<span class="text-body-secondary">Normal user</span>',document.getElementById("broadcastertype").innerHTML=n.data[0].broadcaster_type||'<span class="text-body-secondary">Normal broadcaster</span>',document.getElementById("description").innerHTML=n.data[0].description,document.getElementById("accountage").innerHTML=`${relativeTime(Date.now()-new Date(n.data[0].created_at))} (${n.data[0].created_at})`,n.data[0].profile_image_url?(document.getElementById("profilepicture").classList="text-center ratio ratio-1x1",document.getElementById("profilepicture").innerHTML=`<img src="${n.data[0].profile_image_url}" class="rounded mx-auto d-block" title="${n.data[0].login}'s profile picture" alt="${n.data[0].login}'s profile picture" />`):(document.getElementById("profilepicture").classList="text-center",document.getElementById("profilepicture").innerHTML='<span class="text-body-secondary">No profile picture found</span>'),n.data[0].offline_image_url?(document.getElementById("offlineimage").classList="text-center ratio ratio-16x9",document.getElementById("offlineimage").innerHTML=`<img src="${n.data[0].offline_image_url}" class="rounded mx-auto d-block" title="${n.data[0].login}'s offline image" alt="${n.data[0].login}'s offline image" />`):(document.getElementById("offlineimage").classList="text-center",document.getElementById("offlineimage").innerHTML='<span class="text-body-secondary">No offline image found</span>');let e=await fetch(`https://helper.donk.workers.dev/twitch/streams?user_id=${n.data[0].id}`),t=await e.json();if(t?.data[0]){document.getElementById("channelstatus").innerHTML="Live",document.getElementById("uptime").innerHTML=relativeTime(Date.now()-new Date(t.data[0].started_at)),document.getElementById("category").innerHTML=`<a href="https://www.twitch.tv/directory/game/${t.data[0].game_name}" target="_blank" rel="noopener noreferrer">${t.data[0].game_name}</a>`||'<span class="text-body-secondary">None</span>',document.getElementById("title").innerHTML=t.data[0].title||'<span class="text-body-secondary">None</span>',document.getElementById("viewcount").innerHTML=`${t.data[0].viewer_count.toLocaleString()} ${1==t.data[0].viewer_count?"viewer":"viewers"}`;let e="";for(let n=0;n<t.data[0].tags.length;n++)e+=`<span class="badge rounded-pill text-bg-secondary">${t.data[0].tags[n]}</span> `;document.getElementById("tags").innerHTML=e||'<span class="text-body-secondary">None</span>',document.getElementById("language").innerHTML=getLanguage(t.data[0].language),t.data[0].thumbnail_url?(document.getElementById("thumbnail").classList="text-center ratio ratio-16x9",document.getElementById("thumbnail").innerHTML=`<img src="${t.data[0].thumbnail_url.replace("{width}x{height}","1280x720")}" class="rounded mx-auto d-block" \n          title="${n.data[0].login}'s Stream thumbnail" alt="${n.data[0].login}'s Stream thumbnail" />`):(document.getElementById("thumbnail").classList="text-center",document.getElementById("thumbnail").innerHTML='<span class="text-body-secondary">No thumbnail found</span>')}else{let e=await fetch(`https://helper.donk.workers.dev/twitch/channels?broadcaster_id=${n.data[0].id}`),t=await e.json();if(t?.data[0]){document.getElementById("channelstatus").innerHTML="Offline",document.getElementById("uptime").innerHTML='<span class="text-body-secondary">Channel is offline</span>',document.getElementById("category").innerHTML=`<a href="https://www.twitch.tv/directory/game/${t.data[0].game_name}" target="_blank" rel="noopener noreferrer">${t.data[0].game_name}</a>`||'<span class="text-body-secondary">None</span>',document.getElementById("title").innerHTML=t.data[0].title||'<span class="text-body-secondary">None</span>',document.getElementById("viewcount").innerHTML='<span class="text-body-secondary">Channel is offline</span>';let e="";for(let n=0;n<t.data[0].tags.length;n++)e+=`<span class="badge rounded-pill text-bg-secondary">${t.data[0].tags[n]}</span> `;document.getElementById("tags").innerHTML=e||'<span class="text-body-secondary">None</span>',document.getElementById("language").innerHTML=getLanguage(t.data[0].broadcaster_language),document.getElementById("thumbnail").classList="text-center",document.getElementById("thumbnail").innerHTML='<span class="text-body-secondary">No thumbnail found</span>'}}let a=await fetch(`https://helper.donk.workers.dev/twitch/schedule?broadcaster_id=${n.data[0].id}`),o=await a.json();document.getElementById("upcomingstream").innerHTML=o?.data?.segments?`${relativeTime(new Date(o.data.segments[0].end_time).getTime()-new Date(o.data.segments[0].start_time).getTime())} ${o.data.segments[0]?.category?.name||""} stream titled "${o.data.segments[0]?.title.trim()||""}"  \n          Starting in ${relativeTime(new Date(o.data.segments[0].start_time).getTime()-Date.now())}`:'<span class="text-body-secondary">Could not load schedule</span>';let r=await fetch(`https://helper.donk.workers.dev/twitch/users/extensions?user_id=${n.data[0].id}`),s=await r.json();if(s?.data?.component[1]?.active||s?.data?.component[2]?.active){document.getElementById("componentextensions").innerHTML="<br>";for(let e in s.data.component)s.data.component[e].active&&(document.getElementById("componentextensions").innerHTML+=`\n                <a href="https://dashboard.twitch.tv/extensions/${s.data.component[e].id}" target="_blank" rel="noopener noreferrer">\n                ${s.data.component[e].name}</a><br>`)}else document.getElementById("componentextensions").innerHTML='<span class="text-body-secondary">None</span>';if(s?.data?.overlay[1]?.active){document.getElementById("panelextensions").innerHTML="<br>";for(let e in s.data.overlay)s.data.overlay[e].active&&(document.getElementById("overlayextensions").innerHTML+=`\n                <a href="https://dashboard.twitch.tv/extensions/${s.data.overlay[e].id}" target="_blank" rel="noopener noreferrer">\n                ${s.data.overlay[e].name}</a><br>`)}else document.getElementById("overlayextensions").innerHTML='<span class="text-body-secondary">None</span>';if(s?.data?.panel[1]?.active||s?.data?.panel[2]?.active||s?.data?.panel[3]?.active){document.getElementById("panelextensions").innerHTML="<br>";for(let e in s.data.panel)s.data.panel[e].active&&(document.getElementById("panelextensions").innerHTML+=`\n                <a href="https://dashboard.twitch.tv/extensions/${s.data.panel[e].id}" target="_blank" rel="noopener noreferrer">\n                ${s.data.panel[e].name}</a><br>`)}else document.getElementById("panelextensions").innerHTML='<span class="text-body-secondary">None</span>';let i=await fetch(`https://helper.donk.workers.dev/twitch/teams/channel?broadcaster_id=${n.data[0].id}`),l=await i.json();if(l?.data){document.getElementById("teams").innerHTML="";for(let e=0;e<l.data.length;e++)document.getElementById("teams").innerHTML+=`\n            <h1 class="display-6"><a href="https://www.twitch.tv/team/${l.data[e].team_name}" target="_blank" rel="noopener noreferrer">\n            ${l.data[e].team_display_name}</a></h1>\n            <img src="${l.data[e].thumbnail_url}" class="rounded ratio ratio-1x1 mx-auto d-block" title="${l.data[e].team_display_name}'s team logo" alt="${l.data[e].team_display_name}'s team logo" /><br>`}else document.getElementById("teams").innerHTML='<span class="text-body-secondary">None</span>';let d=await fetch(`https://helper.donk.workers.dev/twitch/chat/settings?broadcaster_id=${n.data[0].id}`),c=await d.json();c?.data[0]?.emote_mode||c?.data[0]?.follower_mode||c?.data[0]?.slow_mode||c?.data[0]?.subscriber_mode||c?.data[0]?.unique_chat_mode?(document.getElementById("chatsettings").innerHTML="<br>",document.getElementById("chatsettings").innerHTML+=`\n            ${c.data[0].emote_mode?"Emote only mode<br>":""}\n            ${c.data[0].follower_mode?`Followers only mode (${relativeTime(6e4*c.data[0].follower_mode_duration).trim()||"0 minutes"})<br>`:""}\n            ${c.data[0].slow_mode?`Slow mode (${relativeTime(1e3*c.data[0].slow_mode_wait_time).trim()})<br>`:""}\n            ${c.data[0].subscriber_mode?"Subscribers only mode<br>":""}\n            ${c.data[0].unique_chat_mode?"Unique-chat mode<br>":""}`):document.getElementById("chatsettings").innerHTML='<span class="text-body-secondary">None</span>';let m=await fetch(`https://helper.donk.workers.dev/twitch/chat/color?user_id=${n.data[0].id}`),g=await m.json();if(g?.data){document.getElementById("linkText").style.color=g.data[0].color;let e={"#0000FF":"Blue","#8A2BE2":"BlueViolet","#5F9EA0":"CadetBlue","#D2691E":"Chocolate","#FF7F50":"Coral","#1E90FF":"DodgerBlue","#B22222":"Firebrick","#008000":"Green","#DAA520":"GoldenRod","#FF69B4":"HotPink","#FF4500":"OrangeRed","#FF0000":"Red","#2E8B57":"SeaGreen","#00FF7F":"SpringGreen","#9ACD32":"YellowGreen"};document.getElementById("chatcolor").innerHTML=`<span style="color: ${g.data[0].color}">${g.data[0].color} <span>\n          <span class="text-body-secondary">${g.data[0].color in e?`Default Twitch color "${e[g.data[0].color]}"`:"Custom color (Twitch Turbo/Prime user)"}</span>`}}else document.getElementById("output").innerHTML=`<p class="text-warning">Could not load ${e}'s info</p>`}catch(t){console.log(t),document.getElementById("output").innerHTML=`<p class="text-warning">Could not load ${e}'s info</p>`}}}async function findTimestamp(){document.getElementById("output").innerHTML="";let e=document.getElementById("exactTime").value,t=document.getElementById("channel").value.toLowerCase().replace(/\s/g,"");if(!t)return void(document.getElementById("output").innerHTML="No Channel provided");if(!e)return void(document.getElementById("output").innerHTML="No time provided");let n=new Date(e).getTime();try{let e=await fetch(`https://helper.donk.workers.dev/twitch/users?login=${t}`),a=await e.json();if(!a?.data[0]?.id)return void(document.getElementById("output").innerHTML="Channel not found");let o=await fetch(`https://helper.donk.workers.dev/twitch/videos?user_id=${a.data[0].id}&first=100`),r=await o.json();r?.data[0]||(document.getElementById("output").innerHTML="Could not find any VODs for the given channel");let s=!1;for(let e=0;e<r.data.length;e++){let t=new Date(r.data[e].created_at).getTime(),a=1e3*convertDuration(r.data[e].duration),o=new Date(t+a).getTime();if(n>=t&&n<=o){s=!0;let a=secondsToTwitchStupidTime(Math.round((n-t)/1e3));document.getElementById("output").innerHTML=`VOD link with timestamp: <a href="${r.data[e].url}?t=${a}" target="_blank" rel="noopener noreferrer">\n        ${r.data[e].url}?t=${a}</a>\n        <br><div id="embed" class="ratio ratio-16x9"></div>`,new Twitch.Embed("embed",{width:"100%",height:"100%",video:r.data[e].id,time:a,parent:["okayeg.com"]})}}s||(document.getElementById("output").innerHTML="Could not find any VODs at the provided time")}catch(e){console.log(e),document.getElementById("output").innerHTML="Something went wrong :( "+e?.message}}async function findClipTimestamp(){document.getElementById("output").innerHTML="";try{let e=document.getElementById("channelClip").value.toLowerCase().replace(/\s/g,""),t=document.getElementById("clip").value.replace(/\s/g,""),n=new URL(t),a="clips.twitch.tv"===n.hostname?/^\/(\w+(?:\/[A-Z]\w+)?(?:[\-\w]*))(?:\/|$)/.exec(n.pathname):/^\/\w+\/clip\/(\w+(?:\/[A-Z]\w+)?(?:[\-\w]*))(?:\/|$)/.exec(n.pathname);if(!e)return void(document.getElementById("output").innerHTML="No Channel provided");if(!t)return void(document.getElementById("output").innerHTML="No clip provided");if(!a[1])return void(document.getElementById("output").innerHTML="Could not find clip ID from provided link");let o=await fetch(`https://helper.donk.workers.dev/twitch/users?login=${e}`),r=await o.json();if(!r?.data[0]?.id)return void(document.getElementById("output").innerHTML="Channel not found");let s,i=await fetch(`https://helper.donk.workers.dev/twitch/clips?id=${a[1]}`),l=await i.json();if(!l?.data[0]?.broadcaster_id)return void(document.getElementById("output").innerHTML="Could not find clip info");if(l?.data[0]?.broadcaster_name?.toLowerCase()==e)return void(document.getElementById("output").innerHTML="Clip channel and provided channel must be different");if(l?.data[0]?.video_id&&l?.data[0]?.vod_offset){let e=await fetch(`https://helper.donk.workers.dev/twitch/videos?id=${l.data[0].video_id}`),t=await e.json();s=new Date(t.data[0].created_at).getTime()+1e3*l.data[0].vod_offset}else s=new Date(l.data[0].created_at).getTime();let d=await fetch(`https://helper.donk.workers.dev/twitch/videos?user_id=${r.data[0].id}&first=100`),c=await d.json();c?.data[0]||(document.getElementById("output").innerHTML="Could not find any VODs that were live at the time the clip was created");let m=!1;for(let e=0;e<c.data.length;e++){let t=new Date(c.data[e].created_at).getTime(),n=1e3*convertDuration(c.data[e].duration),a=new Date(t+n).getTime();if(s>=t&&s<=a){m=!0;let n=secondsToTwitchStupidTime(Math.round((s-t)/1e3));document.getElementById("output").innerHTML=`VOD link with timestamp: <a href="${c.data[e].url}?t=${n}" target="_blank" rel="noopener noreferrer">\n        ${c.data[e].url}?t=${n}</a>\n        <br><div id="embed" class="ratio ratio-16x9"></div>`,new Twitch.Embed("embed",{width:"100%",height:"100%",video:c.data[e].id,time:n,parent:["okayeg.com"]})}}m||(document.getElementById("output").innerHTML="Could not find any VODs that were live at the time the clip was created")}catch(e){console.log(e),document.getElementById("output").innerHTML="Something went wrong :( "+e?.message}}function convertDuration(e){const t=/(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?/.exec(e);if(!t)throw new Error("Invalid duration format");const[,n,a,o]=t;let r=0;return n&&(r+=60*parseInt(n)*60),a&&(r+=60*parseInt(a)),o&&(r+=parseInt(o)),r}function secondsToTimeString(e){let t="";const n=Math.floor(e/3600);e%=3600;const a=Math.floor(e/60),o=e%60;return n&&(t+=n+":"),a&&(t+=a+":"),o&&!a&&(t+="00:"),o&&(t+=o),t}function secondsToTwitchStupidTime(e){const t=Math.floor(e/3600);e%=3600;return`${t}h${Math.floor(e/60)}m${e%60}s`}function addOrdinalSuffix(e){if("number"!=typeof e||isNaN(e))return e;const t=["th","st","nd","rd"],n=Math.abs(e%100);return e+(t[(n-20)%10]||t[n]||t[0])}let countries=[];async function loadSubPrices(e,t){let n=await fetch("/data/subs.json"),a=await fetch(`https://cdn.jsdelivr.net/npm/@fawazahmed0/currency-api@latest/v1/currencies/${t.toLowerCase()}.min.json`),o=await n.json(),r=await a.json(),s=1e6,i=0,l="#27d444",d="#e72222",c="Local Subscription Price",m={};for(let n=0;n<o[e].length;n++){let a=o[e][n].price/r[t.toLowerCase()][o[e][n].currency.toLowerCase()];m[o[e][n].code]={price:o[e][n].currency==t?o[e][n].price:roundToTwo(a)||1},i<a&&(i=a),s>a&&(s=a),countries.some((t=>t.code===o[e][n].code))||countries.push(o[e][n])}if("turbo"==e){c="Turbo Local Pricing";for(let e=0;e<countries.length;e++)countries[e].code in m||(m[countries[e].code]={price:roundToTwo(11.99/r[t.toLowerCase()].usd)})}"primepayout"==e&&(c="Prime gaming sub payout",l="#e72222",d="#27d444"),document.getElementById("map").innerHTML="",new svgMap({targetElementID:"map",showZoomReset:!0,zoomScaleSensitivity:.3,colorMin:l,colorMax:d,colorNoData:"#909090",data:{data:{price:{name:c,format:`{0} ${t}`,thresholdMax:i,thresholdMin:s}},applyData:"price",values:m}})}async function loadRecap(){let e=location.hash.replace("#","").toLowerCase().replace(/\s/g,"");if(!e&&!document.getElementById("username").value)return;document.getElementById("username").value?e=document.getElementById("username").value.toLowerCase().replace(/\s/g,""):document.getElementById("username").value=e,document.getElementById("global").style.display="none",document.getElementById("user").style.display="";let t=await fetch("/data/usersrecap.json"),n=await fetch("/data/globalrecap.json"),a=await t.json(),o=await n.json(),r=a.find((t=>t.username===e));if(!e)return void loadGlobalRecap();if(!r)return document.getElementById("recapusername").innerHTML='\n    Player not found <img src="/pics/sadeg.png" alt="sadeg" />\n    <br><small class="text-body-secondary" style="font-size: 0.3em;">If you changed your username recently try searching for your old username</small>',document.getElementById("seasons").innerHTML="",document.getElementById("egs").style.display="none",document.getElementById("commands").style.display="none",document.getElementById("stocks").style.display="none",document.getElementById("coinflips").style.display="none",document.getElementById("lottery").style.display="none",document.getElementById("trading").style.display="none",document.getElementById("trivia").style.display="none",document.getElementById("duels").style.display="none",document.getElementById("roulette").style.display="none",void window.scrollTo({top:0,behavior:"smooth"});document.getElementById("egscount").innerHTML="",document.getElementById("egseaten").innerHTML="",document.getElementById("egrank").innerHTML="",document.getElementById("egcmd").innerHTML="",document.getElementById("egcmdstats").innerHTML="",document.getElementById("cmd").innerHTML="",document.getElementById("stockcount").innerHTML="",document.getElementById("coinflipstats").innerHTML="",document.getElementById("lotterystats").innerHTML="",document.getElementById("tradingstats").innerHTML="",document.getElementById("triviastats").innerHTML="",document.getElementById("duelstats").innerHTML="",document.getElementById("roulettestats").innerHTML="";let s={0:"ü•á",1:"ü•à",2:"ü•â"};if(console.log(r),document.getElementById("recapusername").innerHTML=`${r.username}'s recap`,12==r.seasons.length?document.getElementById("seasons").innerHTML="Played in all 12 seasons! (1 of 145 players only)":document.getElementById("seasons").innerHTML=`Played in ${1==r.seasons.length?"only":""} ${r.seasons.length} of the 12 seasons`,r?.eguses){if(document.getElementById("egscount").innerHTML=`Total egs earned: ${r.egs.toLocaleString()}`,r.egseaten){let e=o.egseatenArray.indexOf(r.egseaten);document.getElementById("egseaten").innerHTML=`\n      ${r.egseaten.toLocaleString()} egs were eaten using the <kbd>=eat</kbd> command - \n      Rank #${(e+1).toLocaleString()} ${e<3?s[e]:""} \n      ${o.egseatenArray[e+1]==o.egseatenArray[e]?"(tied)":""}`}let e=o.egsArray.indexOf(r.egs);e>-1&&(document.getElementById("egrank").innerHTML=`Your rank is #${(e+1).toLocaleString()} ${e<3?s[e]:""} \n      ${o.egsArray[e+1]==o.egsArray[e]?"(tied)":""}`),document.getElementById("egs").style.display=""}else document.getElementById("egs").style.display="none";if(r.uses||r?.eguses){if(r?.eguses){let e=o.egusesArray.indexOf(r?.eguses);document.getElementById("egcmd").innerHTML=`\n      You used the <kbd>=eg</kbd> command ${(r?.eguses||0).toLocaleString()} ${1==r?.eguses?"time":"times"} - \n      Rank #${(e+1).toLocaleString()} ${e<3?s[e]:""}  ${o.egusesArray[e+1]==o.egusesArray[e]?"(tied)":""}`,document.getElementById("egcmdstats").innerHTML=`\n      The command gave you positive egs ${r.plus.toLocaleString()} ${1==r.plus?"time":"times"} - \n      zero egs ${r.zero.toLocaleString()} ${1==r.zero?"time":"times"} - \n      negative egs ${r.negative.toLocaleString()} ${1==r.negative?"time":"times"}`}let e=o.usesArray.indexOf(r.uses);document.getElementById("cmd").innerHTML=`\n    All other commands were used ${(r.uses-(r?.eguses||0)).toLocaleString()} ${r.uses-(r?.eguses||0)==1?"time":"times"} - \n    Rank #${(e+1).toLocaleString()} ${e<3?s[e]:""}  ${o.usesArray[e+1]==o.usesArray[e]?"(tied)":""}`,document.getElementById("commands").style.display=""}else document.getElementById("commands").style.display="none";if(r.shungite||r.chicken||r.bajcoin||r.copium){let e=o.shungiteArray.indexOf(r.shungite),t=o.chickenArray.indexOf(r.chicken),n=o.bajcoinArray.indexOf(r.bajcoin),a=o.copiumArray.indexOf(r.copium);-1!=e&&(document.getElementById("stockcount").innerHTML+=`\n      ${r.shungite.toLocaleString()} shungite - \n      Rank #${(e+1).toLocaleString()} ${e<3?s[e]:""}  ${o.shungiteArray[e+1]==o.shungiteArray[e]?"(tied)":""}<br>`),-1!=t&&(document.getElementById("stockcount").innerHTML+=`\n      ${r.chicken.toLocaleString()} chicken - \n      Rank #${(t+1).toLocaleString()} ${t<3?s[t]:""}  ${o.chickenArray[t+1]==o.chickenArray[t]?"(tied)":""}<br>`),-1!=n&&(document.getElementById("stockcount").innerHTML+=`\n      ${r.bajcoin.toLocaleString()} bajcoin - \n      Rank #${(n+1).toLocaleString()} ${n<3?s[n]:""}  ${o.bajcoinArray[n+1]==o.bajcoinArray[n]?"(tied)":""}<br>`),-1!=a&&(document.getElementById("stockcount").innerHTML+=`\n      ${r.copium.toLocaleString()} copium - \n      Rank #${(a+1).toLocaleString()} ${a<3?s[a]:""}  ${o.copiumArray[a+1]==o.copiumArray[a]?"(tied)":""}`),document.getElementById("stocks").style.display=""}else document.getElementById("stocks").style.display="none";if(r.coinflips){let e=o.coinflipsArray.indexOf(r.coinflips),t=o.coinflipwinsArray.indexOf(r.coinflipwins),n=roundToTwo(r.coinflipwins/r.coinflips*100),a=o.coinflipwinrateArray.indexOf(n),i="",l="";r.coinflips>10&&(i=`<br>\n      Winrate: ${n}% - \n      Rank #${(a+1).toLocaleString()} ${a<3?s[a]:""}  ${o.coinflipwinrateArray[a+1]==o.coinflipwinrateArray[a]?"(tied)":""}<br>`),l=r.coinflipwins?`\n      Won ${r.coinflipwins.toLocaleString()} ${1==r.coinflipwins?"coinflip only":"coinflips"} - \n      Rank #${(t+1).toLocaleString()} ${t<3?s[t]:""}  ${o.coinflipwinsArray[t+1]==o.coinflipwinsArray[t]?"(tied)":""}<br>\n      Biggest win: ${r.biggestcoinflipwin.toLocaleString()}  - Biggest loss: ${r.biggestcoinfliploss.toLocaleString()}`:`Lost all coinflips :(<br>Biggest loss: ${r.biggestcoinfliploss.toLocaleString()}`,document.getElementById("coinflipstats").innerHTML=`\n    ${r.coinflips.toLocaleString()} coinflips - \n    Rank #${(e+1).toLocaleString()} ${e<3?s[e]:""}  ${o.coinflipsArray[e+1]==o.coinflipsArray[e]?"(tied)":""}<br>\n    ${l}\n    ${i}`,document.getElementById("coinflips").style.display=""}else document.getElementById("coinflips").style.display="none";if(r.lotteryjoins){let e=o.lotteryjoinsArray.indexOf(r.lotteryjoins),t="";if(0==r.lotterywins){let e=o.unluckylotteryArray.indexOf(r.lotteryjoins);t=`You did not win a single lottery - You were the ${0==e?"":`${addOrdinalSuffix(e+1)}`} most unlucky player ${e<3?s[e]:""} \n      ${o.unluckylotteryArray[e+1]==o.unluckylotteryArray[e]?"(tied)":""}`}else{let e=o.lotterywinsArray.indexOf(r.lotterywins);t=`\n      Won ${r.lotterywins} ${1==r.lotterywins?"time":"times"} - \n      Rank #${(e+1).toLocaleString()} ${e<3?s[e]:""}  ${o.lotterywinsArray[e+1]==o.lotterywinsArray[e]?"(tied)":""}<br>`}document.getElementById("lotterystats").innerHTML=`\n    ${r.lotteryjoins.toLocaleString()} lottery tickets bought - \n    Rank #${(e+1).toLocaleString()} ${e<3?s[e]:""}  ${o.lotteryjoinsArray[e+1]==o.lotteryjoinsArray[e]?"(tied)":""}<br>\n    ${t}`,document.getElementById("lottery").style.display=""}else document.getElementById("lottery").style.display="none";if(r.egsgiven||r.egsreceived?(document.getElementById("tradingstats").innerHTML=`${r.egsgiven.toLocaleString()} egs sent to other players -  ${r.egsreceived.toLocaleString()} egs received from other players`,document.getElementById("trading").style.display=""):document.getElementById("trading").style.display="none",r.trivia){let e=o.triviaArray.indexOf(r.trivia);document.getElementById("triviastats").innerHTML=`\n    ${r.trivia.toLocaleString()} trivia questions answered - \n    Rank #${(e+1).toLocaleString()} ${e<3?s[e]:""}  ${o.triviaArray[e+1]==o.triviaArray[e]?"(tied)":""}`,document.getElementById("trivia").style.display=""}else document.getElementById("trivia").style.display="none";if(r.duels){let e=o.duelsArray.indexOf(r.duels),t=o.duelswonArray.indexOf(r.duelswon),n=roundToTwo(r.duelswon/r.duels*100),a=o.duelwinrateArray.indexOf(n),i="",l="";r.duels>10&&(i=`<br>\n      Winrate: ${n}% - \n      Rank #${(a+1).toLocaleString()} ${a<3?s[a]:""}  ${o.duelwinrateArray[a+1]==o.duelwinrateArray[a]?"(tied)":""}<br>`),l=r.duelswon?`\n      Won ${r.duelswon.toLocaleString()} ${1==r.duelswon?"duel":"duels"} - \n      Rank #${(t+1).toLocaleString()} ${t<3?s[t]:""}  ${o.duelswonArray[t+1]==o.duelswonArray[t]?"(tied)":""}<br>\n      Biggest victory: ${r.biggestduelwin.toLocaleString()}  - Biggest defeat: ${r.biggestduelloss.toLocaleString()}`:`Lost all duels :(<br>Biggest defeat: ${r.biggestduelloss.toLocaleString()}`,document.getElementById("duelstats").innerHTML=`\n    ${r.duels.toLocaleString()} duels fought - \n    Rank #${(e+1).toLocaleString()} ${e<3?s[e]:""}  ${o.duelsArray[e+1]==o.duelsArray[e]?"(tied)":""}<br>\n    ${l}\n    ${i}`,document.getElementById("duels").style.display=""}else document.getElementById("duels").style.display="none";if(r.roulettes){let e=o.rouletteswonArray.indexOf(r.rouletteswon),t=roundToTwo(r.rouletteswon/r.roulettes*100),n=o.roulettewinrateArray.indexOf(t),a="",i="";r.roulettes>10&&(a=`\n      Winrate: ${t}% - \n      Rank #${(n+1).toLocaleString()} ${n<3?s[n]:""}  ${o.roulettewinrateArray[n+1]==o.roulettewinrateArray[n]?"(tied)":""}<br>`),i=r.rouletteswon?`\n      Won ${r.rouletteswon.toLocaleString()} ${1==r.rouletteswon?"time":"times"} - \n      Rank #${(e+1).toLocaleString()} ${e<3?s[e]:""}  ${o.rouletteswonArray[e+1]==o.rouletteswonArray[e]?"(tied)":""}<br>\n      Biggest win: ${r.biggestduelwin.toLocaleString()}  - Biggest loss: ${r.biggestrouletteloss.toLocaleString()}<br>`:`Lost all spins :(<br>Biggest loss: ${r.biggestrouletteloss.toLocaleString()}`,document.getElementById("roulettestats").innerHTML=`\n    Roulette wheel spun ${r.roulettes.toLocaleString()} ${1==r.roulettes?"time":"times"}<br>\n    ${i}\n    ${a}`,document.getElementById("roulette").style.display=""}else document.getElementById("roulette").style.display="none";history.replaceState(void 0,void 0,`#${e}`),window.scrollTo({top:0,behavior:"smooth"})}function loadGlobalRecap(){document.getElementById("global").style.display="",document.getElementById("user").style.display="none",window.scrollTo({top:0,behavior:"smooth"}),history.replaceState(void 0,void 0,"#"),document.getElementById("username").value=""}function escapeString(e){return assertString(e),e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2F;").replace(/\\/g,"&#x5C;").replace(/`/g,"&#96;")}function assertString(e){if(!("string"==typeof e||e instanceof String)){let t=_typeof(e);throw null===e?t="null":"object"===t&&(t=e.constructor.name),new TypeError("Expected a string but received a ".concat(t))}}